<?php
  include './connect.php';

  $sql = "SELECT * FROM program";
  $result = mysqli_query($conn, $sql)
    or die("Error in query: $sql " . mysqli_error($conn));
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="css/showproject.css">
    <style> /* css ของ pop up */
      .detail {
        display: none;
        position: fixed;
        z-index: 1;
        padding-top: 100px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgb(0,0,0);
        background-color: rgba(0,0,0,0.4);
    }

      .detail-content {
          background-color: #fefefe;
          margin: auto;
          padding: 20px;
          border: 1px solid #888;
          width: 80%;
    }

      .tb_detail {
          border-collapse: collapse;
          width: 35%;
      }

      .close {
          color: #aaaaaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
    }

      .close:hover, .close:focus {
          color: red;
          text-decoration: none;
          cursor: pointer;
    }
    </style>
</head>
<body>
<?php
    include 'component/admin_nav.php';
?>

<table align="center" class="top">
  <tr>
    <th>จัดการโครงการ</th>
    <td align="right"><a href="./addProject.php"><u>เพิ่มโครงการ</u></a></td>
  </tr>
</table>

<table align="center"  class="show">
  <tr>
    <th>โครงการ</th>
    <td ></td>
  </tr>
  <?php 
    while($rs = mysqli_fetch_array($result)) {
  ?>
  <tr>
    <td><?php echo "$rs[p_name]"; ?></td>
    <td align="center"><input type="hidden" name="p_id" value="<?php echo $rs['p_id']; ?>">
    <button type="submit" name="btn_detail" value="<?php $rs['p_id']; ?>">รายละเอียด</button></td></a>
  </tr>
  <?php
    }
    mysqli_close($conn);
  ?>
</table>

<div id="showDetail" class="detail">  <!-- หน้าต่าง popup ปุ่มรายละเอียด-->
  <div class="detail-content">
    <span class="close">&times;</span>
    <p align="center">รายละเอียดโครงการ</p><br>
    <?php
      $p_id = $_GET['btn_detail'];
      // ตรวจสอบว่ามีการส่ง p_id มาหรือไม่
      if(isset($_POST['btn_detail'])) {
        echo "$p_id   1111";
        $sql = "SELECT * FROM program WHERE p_id = '$p_id'";
        $result = mysqli_query($conn, $sql)
          or die("Error in query: $sql " . mysqli_error($conn));
        while($rs = mysqli_fetch_array($result)) {
          echo "$rs[p_name]";
        }
      }echo "$p_id";
    ?>
    <table align="center" class="tb_detail" >
      <tr>
        <td>ชื่อโครงการ</td>
        <td>asdsadas</td>
      </tr>
      <tr>
        <td>วันที่เริ่ม</td>
        <td>asdsadas</td>
      </tr>
      <tr>
        <td>วันที่สิ้นสุด</td>
        <td>asdsadas</td>
      </tr>
      <tr>
        <td>ชั่วโมงสะสม</td>
        <td>asdsadas</td>
      </tr>
      <tr>
        <td>อาจารย์ผู้คุม</td>
        <td>asdsadas</td>
      </tr>
      <tr>
        <td>ผู้นวดในโครงการ</td>
        <td>asdsadas</td>
      </tr>
    </table>
    <br>
    <div align="center"> <!-- ปุ่มแก้ไข ลบ -->
      <button>แก้ไข</button> &nbsp;&nbsp;&nbsp;&nbsp; <button>ลบ</button>
  </div>
</div>

<script> /* ควบคุมหน้าต่าง popup ปุ่มรายละเอียด */
var modal = document.getElementById("showDetail");
var btn = document.getElementsByName("btn_detail");
var span = document.getElementsByClassName("close")[0];

for (var i = 0; i < btn.length; i++) {
  btn[i].onclick = function() {
  console.log("Button clicked");
  modal.style.display = "block";
}
}


span.onclick = function() {
  console.log("Close button clicked");
  modal.style.display = "none";
}

window.onclick = function(event) {
  console.log("Window clicked");
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>

</body>
</html>
